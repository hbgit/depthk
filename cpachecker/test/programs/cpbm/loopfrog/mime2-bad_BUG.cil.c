/* Generated by CIL v. 1.3.7 */
/* print_CIL_Input is true */

#line 211 "/usr/lib/gcc/x86_64-linux-gnu/4.4.3/include/stddef.h"
typedef unsigned long size_t;
#line 31 "/usr/include/bits/types.h"
typedef unsigned char __u_char;
#line 32 "/usr/include/bits/types.h"
typedef unsigned short __u_short;
#line 34 "/usr/include/bits/types.h"
typedef unsigned long __u_long;
#line 134 "/usr/include/bits/types.h"
typedef unsigned long __dev_t;
#line 135 "/usr/include/bits/types.h"
typedef unsigned int __uid_t;
#line 136 "/usr/include/bits/types.h"
typedef unsigned int __gid_t;
#line 137 "/usr/include/bits/types.h"
typedef unsigned long __ino_t;
#line 141 "/usr/include/bits/types.h"
typedef long __off_t;
#line 142 "/usr/include/bits/types.h"
typedef long __off64_t;
#line 149 "/usr/include/bits/types.h"
typedef long __time_t;
#line 45 "/usr/include/stdio.h"
struct _IO_FILE;
#line 45
struct _IO_FILE;
#line 49 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 170 "/usr/include/libio.h"
struct _IO_FILE;
#line 180 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 186 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 271 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 35 "/usr/include/sys/types.h"
typedef __u_char u_char;
#line 36 "/usr/include/sys/types.h"
typedef __u_short u_short;
#line 38 "/usr/include/sys/types.h"
typedef __u_long u_long;
#line 50 "/usr/include/sys/types.h"
typedef __ino_t ino_t;
#line 62 "/usr/include/sys/types.h"
typedef __dev_t dev_t;
#line 67 "/usr/include/sys/types.h"
typedef __gid_t gid_t;
#line 82 "/usr/include/sys/types.h"
typedef __uid_t uid_t;
#line 76 "/usr/include/time.h"
typedef __time_t time_t;
#line 74 "mime2.h"
struct header {
   char *h_field ;
   char *h_value ;
   struct header *h_link ;
   u_short h_flags ;
};
#line 83 "mime2.h"
typedef struct header HDR;
#line 86 "mime2.h"
struct address {
   char *q_paddr ;
   char *q_user ;
   char *q_ruser ;
   char *q_host ;
   u_long q_flags ;
   uid_t q_uid ;
   gid_t q_gid ;
   char *q_home ;
   char *q_fullname ;
   struct address *q_next ;
   struct address *q_alias ;
   char *q_owner ;
   struct address *q_tchain ;
   char *q_orcpt ;
   char *q_status ;
   char *q_rstatus ;
   char *q_statmta ;
   short q_specificity ;
};
#line 110 "mime2.h"
typedef struct address ADDRESS;
#line 114 "mime2.h"
struct envelope {
   HDR *e_header ;
   long e_msgpriority ;
   time_t e_ctime ;
   char *e_to ;
   ADDRESS e_from ;
   char *e_sender ;
   char **e_fromdomain ;
   ADDRESS *e_sendqueue ;
   ADDRESS *e_errorqueue ;
   long e_msgsize ;
   long e_flags ;
   int e_nrcpts ;
   short e_class ;
   short e_hopcount ;
   short e_nsent ;
   short e_sendmode ;
   short e_errormode ;
   short e_timeoutclass ;
   struct envelope *e_parent ;
   struct envelope *e_sibling ;
   char *e_bodytype ;
   FILE *e_dfp ;
   char *e_id ;
   FILE *e_xfp ;
   FILE *e_lockfp ;
   char *e_message ;
   char *e_statmsg ;
   char *e_msgboundary ;
   char *e_origrcpt ;
   char *e_envid ;
   char *e_status ;
   time_t e_dtime ;
   int e_ntries ;
   dev_t e_dfdev ;
   ino_t e_dfino ;
   char *e_macro[256] ;
};
#line 155 "mime2.h"
typedef struct envelope ENVELOPE;
#line 214 "/usr/include/stdio.h"
extern int fclose(FILE *__stream ) ;
#line 249
extern FILE *fopen(char const   * __restrict  __filename , char const   * __restrict  __modes ) ;
#line 339
extern int printf(char const   * __restrict  __format  , ...) ;
#line 513
extern int fgetc(FILE *__stream ) ;
#line 471 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *malloc(size_t __size )  __attribute__((__malloc__)) ;
#line 127 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *strcpy(char * __restrict  __dest , char const   * __restrict  __src )  __attribute__((__nonnull__(1,2))) ;
#line 534
extern  __attribute__((__nothrow__)) int strcasecmp(char const   *__s1 , char const   *__s2 )  __attribute__((__pure__,
__nonnull__(1,2))) ;
#line 81 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) unsigned short const   **__ctype_b_loc(void)  __attribute__((__const__)) ;
#line 71 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void __assert_fail(char const   *__assertion ,
                                                                      char const   *__file ,
                                                                      unsigned int __line ,
                                                                      char const   *__function ) ;
#line 69 "mime2-bad.c"
void mime7to8(HDR *header , ENVELOPE *e ) ;
#line 70
char *hvalue(char *field , HDR *header ) ;
#line 72 "mime2-bad.c"
int main(int argc , char **argv ) 
{ HDR *header ;
  register ENVELOPE *e ;
  FILE *temp ;
  void *tmp ;
  void *tmp___0 ;
  unsigned long __cil_tmp8 ;
  unsigned long __cil_tmp9 ;
  unsigned long __cil_tmp10 ;
  unsigned long __cil_tmp11 ;
  char **__cil_tmp12 ;
  char *__cil_tmp13 ;
  char const   * __restrict  __cil_tmp14 ;
  char const   * __restrict  __cil_tmp15 ;
  unsigned long __cil_tmp16 ;
  unsigned long __cil_tmp17 ;

  {
#line 78
  if (argc == 2) {

  } else {
    {
#line 78
    __assert_fail("argc==2", "mime2-bad.c", 78U, "main");
    }
  }
  {
#line 80
  tmp = malloc(32UL);
#line 80
  header = (HDR *)tmp;
#line 82
  *((char **)header) = (char *)"Content-Transfer-Encoding";
#line 83
  __cil_tmp8 = (unsigned long )header;
#line 83
  __cil_tmp9 = __cil_tmp8 + 8;
#line 83
  *((char **)__cil_tmp9) = (char *)"base64";
#line 85
  tmp___0 = malloc(2416UL);
#line 85
  e = (ENVELOPE *)tmp___0;
#line 86
  __cil_tmp10 = (unsigned long )e;
#line 86
  __cil_tmp11 = __cil_tmp10 + 264;
#line 86
  *((char **)__cil_tmp11) = (char *)"First Entry";
#line 88
  __cil_tmp12 = argv + 1;
#line 88
  __cil_tmp13 = *__cil_tmp12;
#line 88
  __cil_tmp14 = (char const   * __restrict  )__cil_tmp13;
#line 88
  __cil_tmp15 = (char const   * __restrict  )"r";
#line 88
  temp = fopen(__cil_tmp14, __cil_tmp15);
#line 90
  __cil_tmp16 = (unsigned long )e;
#line 90
  __cil_tmp17 = __cil_tmp16 + 256;
#line 90
  *((FILE **)__cil_tmp17) = temp;
#line 91
  mime7to8(header, e);
#line 93
  fclose(temp);
  }
#line 95
  return (0);
#line 98
  return (0);
}
}
#line 101 "mime2-bad.c"
static char index_64[128]  = 
#line 101
  {      (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)62, 
        (char)-1,      (char)-1,      (char)-1,      (char)63, 
        (char)52,      (char)53,      (char)54,      (char)55, 
        (char)56,      (char)57,      (char)58,      (char)59, 
        (char)60,      (char)61,      (char)-1,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)0,      (char)1,      (char)2, 
        (char)3,      (char)4,      (char)5,      (char)6, 
        (char)7,      (char)8,      (char)9,      (char)10, 
        (char)11,      (char)12,      (char)13,      (char)14, 
        (char)15,      (char)16,      (char)17,      (char)18, 
        (char)19,      (char)20,      (char)21,      (char)22, 
        (char)23,      (char)24,      (char)25,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1, 
        (char)-1,      (char)26,      (char)27,      (char)28, 
        (char)29,      (char)30,      (char)31,      (char)32, 
        (char)33,      (char)34,      (char)35,      (char)36, 
        (char)37,      (char)38,      (char)39,      (char)40, 
        (char)41,      (char)42,      (char)43,      (char)44, 
        (char)45,      (char)46,      (char)47,      (char)48, 
        (char)49,      (char)50,      (char)51,      (char)-1, 
        (char)-1,      (char)-1,      (char)-1,      (char)-1};
#line 139 "mime2-bad.c"
void mime7to8(HDR *header , ENVELOPE *e ) 
{ register char *p ;
  u_char *fbufp ;
  char canary[10] ;
  u_char fbuf[51] ;
  int c1 ;
  int c2 ;
  int c3 ;
  int c4 ;
  unsigned short const   **tmp ;
  unsigned short const   **tmp___0 ;
  unsigned short const   **tmp___1 ;
  unsigned short const   **tmp___2 ;
  u_char *tmp___3 ;
  u_char *tmp___4 ;
  u_char *tmp___5 ;
  int tmp___6 ;
  unsigned long __cil_tmp19 ;
  unsigned long __cil_tmp20 ;
  char *__cil_tmp21 ;
  char * __restrict  __cil_tmp22 ;
  char const   * __restrict  __cil_tmp23 ;
  char *__cil_tmp24 ;
  void *__cil_tmp25 ;
  unsigned long __cil_tmp26 ;
  unsigned long __cil_tmp27 ;
  char const   * __restrict  __cil_tmp28 ;
  char const   *__cil_tmp29 ;
  unsigned long __cil_tmp30 ;
  unsigned long __cil_tmp31 ;
  unsigned long __cil_tmp32 ;
  unsigned long __cil_tmp33 ;
  FILE *__cil_tmp34 ;
  int __cil_tmp35 ;
  unsigned short const   *__cil_tmp36 ;
  unsigned short const   *__cil_tmp37 ;
  unsigned short __cil_tmp38 ;
  int __cil_tmp39 ;
  unsigned long __cil_tmp40 ;
  unsigned long __cil_tmp41 ;
  FILE *__cil_tmp42 ;
  int __cil_tmp43 ;
  unsigned short const   *__cil_tmp44 ;
  unsigned short const   *__cil_tmp45 ;
  unsigned short __cil_tmp46 ;
  int __cil_tmp47 ;
  unsigned long __cil_tmp48 ;
  unsigned long __cil_tmp49 ;
  FILE *__cil_tmp50 ;
  int __cil_tmp51 ;
  unsigned short const   *__cil_tmp52 ;
  unsigned short const   *__cil_tmp53 ;
  unsigned short __cil_tmp54 ;
  int __cil_tmp55 ;
  unsigned long __cil_tmp56 ;
  unsigned long __cil_tmp57 ;
  FILE *__cil_tmp58 ;
  int __cil_tmp59 ;
  unsigned short const   *__cil_tmp60 ;
  unsigned short const   *__cil_tmp61 ;
  unsigned short __cil_tmp62 ;
  int __cil_tmp63 ;
  unsigned long __cil_tmp64 ;
  unsigned long __cil_tmp65 ;
  char __cil_tmp66 ;
  unsigned long __cil_tmp67 ;
  unsigned long __cil_tmp68 ;
  char __cil_tmp69 ;
  int __cil_tmp70 ;
  int __cil_tmp71 ;
  int __cil_tmp72 ;
  int __cil_tmp73 ;
  u_char __cil_tmp74 ;
  int __cil_tmp75 ;
  unsigned long __cil_tmp76 ;
  unsigned long __cil_tmp77 ;
  u_char *__cil_tmp78 ;
  unsigned long __cil_tmp79 ;
  unsigned long __cil_tmp80 ;
  unsigned long __cil_tmp81 ;
  u_char *__cil_tmp82 ;
  unsigned long __cil_tmp83 ;
  u_char __cil_tmp84 ;
  int __cil_tmp85 ;
  u_char __cil_tmp86 ;
  int __cil_tmp87 ;
  char const   * __restrict  __cil_tmp88 ;
  unsigned long __cil_tmp89 ;
  unsigned long __cil_tmp90 ;
  unsigned long __cil_tmp91 ;
  unsigned long __cil_tmp92 ;
  char __cil_tmp93 ;
  int __cil_tmp94 ;
  int __cil_tmp95 ;
  int __cil_tmp96 ;
  int __cil_tmp97 ;
  int __cil_tmp98 ;
  u_char __cil_tmp99 ;
  int __cil_tmp100 ;
  unsigned long __cil_tmp101 ;
  unsigned long __cil_tmp102 ;
  u_char *__cil_tmp103 ;
  unsigned long __cil_tmp104 ;
  unsigned long __cil_tmp105 ;
  unsigned long __cil_tmp106 ;
  u_char *__cil_tmp107 ;
  unsigned long __cil_tmp108 ;
  u_char __cil_tmp109 ;
  int __cil_tmp110 ;
  u_char __cil_tmp111 ;
  int __cil_tmp112 ;
  char const   * __restrict  __cil_tmp113 ;
  unsigned long __cil_tmp114 ;
  unsigned long __cil_tmp115 ;
  unsigned long __cil_tmp116 ;
  unsigned long __cil_tmp117 ;
  char __cil_tmp118 ;
  int __cil_tmp119 ;
  int __cil_tmp120 ;
  int __cil_tmp121 ;
  u_char __cil_tmp122 ;
  int __cil_tmp123 ;
  unsigned long __cil_tmp124 ;
  unsigned long __cil_tmp125 ;
  u_char *__cil_tmp126 ;
  unsigned long __cil_tmp127 ;
  unsigned long __cil_tmp128 ;
  unsigned long __cil_tmp129 ;
  u_char *__cil_tmp130 ;
  unsigned long __cil_tmp131 ;
  u_char __cil_tmp132 ;
  int __cil_tmp133 ;
  u_char __cil_tmp134 ;
  int __cil_tmp135 ;
  char const   * __restrict  __cil_tmp136 ;
  unsigned long __cil_tmp137 ;
  unsigned long __cil_tmp138 ;
  unsigned long __cil_tmp139 ;
  unsigned long __cil_tmp140 ;
  u_char *__cil_tmp141 ;
  unsigned long __cil_tmp142 ;
  unsigned long __cil_tmp143 ;
  char const   * __restrict  __cil_tmp144 ;
  char const   * __restrict  __cil_tmp145 ;
  char const   * __restrict  __cil_tmp146 ;
  unsigned long __cil_tmp147 ;
  unsigned long __cil_tmp148 ;
  char *__cil_tmp149 ;

  {
  {
#line 150
  __cil_tmp19 = 0 * 1UL;
#line 150
  __cil_tmp20 = (unsigned long )(canary) + __cil_tmp19;
#line 150
  __cil_tmp21 = (char *)__cil_tmp20;
#line 150
  __cil_tmp22 = (char * __restrict  )__cil_tmp21;
#line 150
  __cil_tmp23 = (char const   * __restrict  )"GOOD";
#line 150
  strcpy(__cil_tmp22, __cil_tmp23);
#line 152
  __cil_tmp24 = (char *)"Content-Transfer-Encoding";
#line 152
  p = hvalue(__cil_tmp24, header);
  }
  {
#line 153
  __cil_tmp25 = (void *)0;
#line 153
  __cil_tmp26 = (unsigned long )__cil_tmp25;
#line 153
  __cil_tmp27 = (unsigned long )p;
#line 153
  if (__cil_tmp27 == __cil_tmp26) {
    {
#line 155
    __cil_tmp28 = (char const   * __restrict  )"Content-Transfer-Encoding not found in header\n";
#line 155
    printf(__cil_tmp28);
    }
#line 156
    return;
  } else {

  }
  }
  {
#line 165
  __cil_tmp29 = (char const   *)p;
#line 165
  tmp___6 = strcasecmp(__cil_tmp29, "base64");
  }
#line 165
  if (tmp___6 == 0) {
#line 169
    __cil_tmp30 = 0 * 1UL;
#line 169
    __cil_tmp31 = (unsigned long )(fbuf) + __cil_tmp30;
#line 169
    fbufp = (u_char *)__cil_tmp31;
    {
#line 170
    while (1) {
      while_continue: /* CIL Label */ ;
      {
#line 170
      __cil_tmp32 = (unsigned long )e;
#line 170
      __cil_tmp33 = __cil_tmp32 + 256;
#line 170
      __cil_tmp34 = *((FILE **)__cil_tmp33);
#line 170
      c1 = fgetc(__cil_tmp34);
      }
#line 170
      if (c1 != -1) {

      } else {
#line 170
        goto while_break;
      }
      {
#line 172
      __cil_tmp35 = c1 & -128;
#line 172
      if (__cil_tmp35 == 0) {
        {
#line 172
        tmp = __ctype_b_loc();
        }
        {
#line 172
        __cil_tmp36 = *tmp;
#line 172
        __cil_tmp37 = __cil_tmp36 + c1;
#line 172
        __cil_tmp38 = *__cil_tmp37;
#line 172
        __cil_tmp39 = (int const   )__cil_tmp38;
#line 172
        if (__cil_tmp39 & 8192) {
#line 173
          goto while_continue;
        } else {

        }
        }
      } else {

      }
      }
      {
#line 175
      while (1) {
        while_continue___0: /* CIL Label */ ;
        {
#line 177
        __cil_tmp40 = (unsigned long )e;
#line 177
        __cil_tmp41 = __cil_tmp40 + 256;
#line 177
        __cil_tmp42 = *((FILE **)__cil_tmp41);
#line 177
        c2 = fgetc(__cil_tmp42);
        }
        {
#line 175
        __cil_tmp43 = c2 & -128;
#line 175
        if (__cil_tmp43 == 0) {
          {
#line 175
          tmp___0 = __ctype_b_loc();
          }
          {
#line 175
          __cil_tmp44 = *tmp___0;
#line 175
          __cil_tmp45 = __cil_tmp44 + c2;
#line 175
          __cil_tmp46 = *__cil_tmp45;
#line 175
          __cil_tmp47 = (int const   )__cil_tmp46;
#line 175
          if (__cil_tmp47 & 8192) {

          } else {
#line 175
            goto while_break___0;
          }
          }
        } else {
#line 175
          goto while_break___0;
        }
        }
      }
      while_break___0: /* CIL Label */ ;
      }
#line 179
      if (c2 == -1) {
#line 180
        goto while_break;
      } else {

      }
      {
#line 182
      while (1) {
        while_continue___1: /* CIL Label */ ;
        {
#line 184
        __cil_tmp48 = (unsigned long )e;
#line 184
        __cil_tmp49 = __cil_tmp48 + 256;
#line 184
        __cil_tmp50 = *((FILE **)__cil_tmp49);
#line 184
        c3 = fgetc(__cil_tmp50);
        }
        {
#line 182
        __cil_tmp51 = c3 & -128;
#line 182
        if (__cil_tmp51 == 0) {
          {
#line 182
          tmp___1 = __ctype_b_loc();
          }
          {
#line 182
          __cil_tmp52 = *tmp___1;
#line 182
          __cil_tmp53 = __cil_tmp52 + c3;
#line 182
          __cil_tmp54 = *__cil_tmp53;
#line 182
          __cil_tmp55 = (int const   )__cil_tmp54;
#line 182
          if (__cil_tmp55 & 8192) {

          } else {
#line 182
            goto while_break___1;
          }
          }
        } else {
#line 182
          goto while_break___1;
        }
        }
      }
      while_break___1: /* CIL Label */ ;
      }
#line 186
      if (c3 == -1) {
#line 187
        goto while_break;
      } else {

      }
      {
#line 189
      while (1) {
        while_continue___2: /* CIL Label */ ;
        {
#line 191
        __cil_tmp56 = (unsigned long )e;
#line 191
        __cil_tmp57 = __cil_tmp56 + 256;
#line 191
        __cil_tmp58 = *((FILE **)__cil_tmp57);
#line 191
        c4 = fgetc(__cil_tmp58);
        }
        {
#line 189
        __cil_tmp59 = c4 & -128;
#line 189
        if (__cil_tmp59 == 0) {
          {
#line 189
          tmp___2 = __ctype_b_loc();
          }
          {
#line 189
          __cil_tmp60 = *tmp___2;
#line 189
          __cil_tmp61 = __cil_tmp60 + c4;
#line 189
          __cil_tmp62 = *__cil_tmp61;
#line 189
          __cil_tmp63 = (int const   )__cil_tmp62;
#line 189
          if (__cil_tmp63 & 8192) {

          } else {
#line 189
            goto while_break___2;
          }
          }
        } else {
#line 189
          goto while_break___2;
        }
        }
      }
      while_break___2: /* CIL Label */ ;
      }
#line 193
      if (c4 == -1) {
#line 194
        goto while_break;
      } else {

      }
#line 196
      if (c1 == 61) {
#line 197
        goto while_continue;
      } else
#line 196
      if (c2 == 61) {
#line 197
        goto while_continue;
      } else {

      }
#line 198
      if (c1 < 0) {
#line 198
        c1 = -1;
      } else
#line 198
      if (c1 > 127) {
#line 198
        c1 = -1;
      } else {
#line 198
        __cil_tmp64 = c1 * 1UL;
#line 198
        __cil_tmp65 = (unsigned long )(index_64) + __cil_tmp64;
#line 198
        __cil_tmp66 = *((char *)__cil_tmp65);
#line 198
        c1 = (int )__cil_tmp66;
      }
#line 199
      if (c2 < 0) {
#line 199
        c2 = -1;
      } else
#line 199
      if (c2 > 127) {
#line 199
        c2 = -1;
      } else {
#line 199
        __cil_tmp67 = c2 * 1UL;
#line 199
        __cil_tmp68 = (unsigned long )(index_64) + __cil_tmp67;
#line 199
        __cil_tmp69 = *((char *)__cil_tmp68);
#line 199
        c2 = (int )__cil_tmp69;
      }
#line 204
      __cil_tmp70 = c2 & 48;
#line 204
      __cil_tmp71 = __cil_tmp70 >> 4;
#line 204
      __cil_tmp72 = c1 << 2;
#line 204
      __cil_tmp73 = __cil_tmp72 | __cil_tmp71;
#line 204
      *fbufp = (u_char )__cil_tmp73;
#line 214
      tmp___3 = fbufp;
#line 214
      fbufp = fbufp + 1;
      {
#line 214
      __cil_tmp74 = *tmp___3;
#line 214
      __cil_tmp75 = (int )__cil_tmp74;
#line 214
      if (__cil_tmp75 == 10) {
#line 214
        goto __TESTCLAIM_2;
      } else {
        {
#line 214
        __cil_tmp76 = 50 * 1UL;
#line 214
        __cil_tmp77 = (unsigned long )(fbuf) + __cil_tmp76;
#line 214
        __cil_tmp78 = (u_char *)__cil_tmp77;
#line 214
        __cil_tmp79 = (unsigned long )__cil_tmp78;
#line 214
        __cil_tmp80 = 0 * 1UL;
#line 214
        __cil_tmp81 = (unsigned long )(fbuf) + __cil_tmp80;
#line 214
        __cil_tmp82 = (u_char *)__cil_tmp81;
#line 214
        __cil_tmp83 = (unsigned long )__cil_tmp82;
#line 214
        if (__cil_tmp83 >= __cil_tmp79) {
          __TESTCLAIM_2: 
#line 218
          fbufp = fbufp - 1;
          {
#line 218
          __cil_tmp84 = *fbufp;
#line 218
          __cil_tmp85 = (int )__cil_tmp84;
#line 218
          if (__cil_tmp85 != 10) {
#line 219
            fbufp = fbufp + 1;
          } else {
#line 218
            fbufp = fbufp - 1;
            {
#line 218
            __cil_tmp86 = *fbufp;
#line 218
            __cil_tmp87 = (int )__cil_tmp86;
#line 218
            if (__cil_tmp87 != 13) {
#line 219
              fbufp = fbufp + 1;
            } else {

            }
            }
          }
          }
          {
#line 221
          *fbufp = (u_char )'\000';
#line 223
          __cil_tmp88 = (char const   * __restrict  )"resetting fbufp\n";
#line 223
          printf(__cil_tmp88);
#line 224
          __cil_tmp89 = 0 * 1UL;
#line 224
          __cil_tmp90 = (unsigned long )(fbuf) + __cil_tmp89;
#line 224
          fbufp = (u_char *)__cil_tmp90;
          }
        } else {

        }
        }
      }
      }
#line 227
      if (c3 == 61) {
#line 228
        goto while_continue;
      } else {

      }
#line 229
      if (c3 < 0) {
#line 229
        c3 = -1;
      } else
#line 229
      if (c3 > 127) {
#line 229
        c3 = -1;
      } else {
#line 229
        __cil_tmp91 = c3 * 1UL;
#line 229
        __cil_tmp92 = (unsigned long )(index_64) + __cil_tmp91;
#line 229
        __cil_tmp93 = *((char *)__cil_tmp92);
#line 229
        c3 = (int )__cil_tmp93;
      }
#line 233
      __cil_tmp94 = c3 & 60;
#line 233
      __cil_tmp95 = __cil_tmp94 >> 2;
#line 233
      __cil_tmp96 = c2 & 15;
#line 233
      __cil_tmp97 = __cil_tmp96 << 4;
#line 233
      __cil_tmp98 = __cil_tmp97 | __cil_tmp95;
#line 233
      *fbufp = (u_char )__cil_tmp98;
#line 234
      tmp___4 = fbufp;
#line 234
      fbufp = fbufp + 1;
      {
#line 234
      __cil_tmp99 = *tmp___4;
#line 234
      __cil_tmp100 = (int )__cil_tmp99;
#line 234
      if (__cil_tmp100 == 10) {
#line 234
        goto __TESTCLAIM_4;
      } else {
        {
#line 234
        __cil_tmp101 = 50 * 1UL;
#line 234
        __cil_tmp102 = (unsigned long )(fbuf) + __cil_tmp101;
#line 234
        __cil_tmp103 = (u_char *)__cil_tmp102;
#line 234
        __cil_tmp104 = (unsigned long )__cil_tmp103;
#line 234
        __cil_tmp105 = 0 * 1UL;
#line 234
        __cil_tmp106 = (unsigned long )(fbuf) + __cil_tmp105;
#line 234
        __cil_tmp107 = (u_char *)__cil_tmp106;
#line 234
        __cil_tmp108 = (unsigned long )__cil_tmp107;
#line 234
        if (__cil_tmp108 >= __cil_tmp104) {
          __TESTCLAIM_4: 
#line 238
          fbufp = fbufp - 1;
          {
#line 238
          __cil_tmp109 = *fbufp;
#line 238
          __cil_tmp110 = (int )__cil_tmp109;
#line 238
          if (__cil_tmp110 != 10) {
#line 239
            fbufp = fbufp + 1;
          } else {
#line 238
            fbufp = fbufp - 1;
            {
#line 238
            __cil_tmp111 = *fbufp;
#line 238
            __cil_tmp112 = (int )__cil_tmp111;
#line 238
            if (__cil_tmp112 != 13) {
#line 239
              fbufp = fbufp + 1;
            } else {

            }
            }
          }
          }
          {
#line 240
          *fbufp = (u_char )'\000';
#line 242
          __cil_tmp113 = (char const   * __restrict  )"resetting fbufp\n";
#line 242
          printf(__cil_tmp113);
#line 243
          __cil_tmp114 = 0 * 1UL;
#line 243
          __cil_tmp115 = (unsigned long )(fbuf) + __cil_tmp114;
#line 243
          fbufp = (u_char *)__cil_tmp115;
          }
        } else {

        }
        }
      }
      }
#line 245
      if (c4 == 61) {
#line 246
        goto while_continue;
      } else {

      }
#line 247
      if (c4 < 0) {
#line 247
        c4 = -1;
      } else
#line 247
      if (c4 > 127) {
#line 247
        c4 = -1;
      } else {
#line 247
        __cil_tmp116 = c4 * 1UL;
#line 247
        __cil_tmp117 = (unsigned long )(index_64) + __cil_tmp116;
#line 247
        __cil_tmp118 = *((char *)__cil_tmp117);
#line 247
        c4 = (int )__cil_tmp118;
      }
#line 251
      __cil_tmp119 = c3 & 3;
#line 251
      __cil_tmp120 = __cil_tmp119 << 6;
#line 251
      __cil_tmp121 = __cil_tmp120 | c4;
#line 251
      *fbufp = (u_char )__cil_tmp121;
#line 252
      tmp___5 = fbufp;
#line 252
      fbufp = fbufp + 1;
      {
#line 252
      __cil_tmp122 = *tmp___5;
#line 252
      __cil_tmp123 = (int )__cil_tmp122;
#line 252
      if (__cil_tmp123 == 10) {
#line 252
        goto __TESTCLAIM_6;
      } else {
        {
#line 252
        __cil_tmp124 = 50 * 1UL;
#line 252
        __cil_tmp125 = (unsigned long )(fbuf) + __cil_tmp124;
#line 252
        __cil_tmp126 = (u_char *)__cil_tmp125;
#line 252
        __cil_tmp127 = (unsigned long )__cil_tmp126;
#line 252
        __cil_tmp128 = 0 * 1UL;
#line 252
        __cil_tmp129 = (unsigned long )(fbuf) + __cil_tmp128;
#line 252
        __cil_tmp130 = (u_char *)__cil_tmp129;
#line 252
        __cil_tmp131 = (unsigned long )__cil_tmp130;
#line 252
        if (__cil_tmp131 >= __cil_tmp127) {
          __TESTCLAIM_6: 
#line 256
          fbufp = fbufp - 1;
          {
#line 256
          __cil_tmp132 = *fbufp;
#line 256
          __cil_tmp133 = (int )__cil_tmp132;
#line 256
          if (__cil_tmp133 != 10) {
#line 257
            fbufp = fbufp + 1;
          } else {
#line 256
            fbufp = fbufp - 1;
            {
#line 256
            __cil_tmp134 = *fbufp;
#line 256
            __cil_tmp135 = (int )__cil_tmp134;
#line 256
            if (__cil_tmp135 != 13) {
#line 257
              fbufp = fbufp + 1;
            } else {

            }
            }
          }
          }
          {
#line 258
          *fbufp = (u_char )'\000';
#line 260
          __cil_tmp136 = (char const   * __restrict  )"resetting fbufp\n";
#line 260
          printf(__cil_tmp136);
#line 261
          __cil_tmp137 = 0 * 1UL;
#line 261
          __cil_tmp138 = (unsigned long )(fbuf) + __cil_tmp137;
#line 261
          fbufp = (u_char *)__cil_tmp138;
          }
        } else {

        }
        }
      }
      }
    }
    while_break: /* CIL Label */ ;
    }
    {
#line 266
    __cil_tmp139 = 0 * 1UL;
#line 266
    __cil_tmp140 = (unsigned long )(fbuf) + __cil_tmp139;
#line 266
    __cil_tmp141 = (u_char *)__cil_tmp140;
#line 266
    __cil_tmp142 = (unsigned long )__cil_tmp141;
#line 266
    __cil_tmp143 = (unsigned long )fbufp;
#line 266
    if (__cil_tmp143 > __cil_tmp142) {
#line 270
      *fbufp = (u_char )'\000';
    } else {

    }
    }
  } else {
    {
#line 277
    __cil_tmp144 = (char const   * __restrict  )"We only support base64 encoding...\n";
#line 277
    printf(__cil_tmp144);
    }
  }
  {
#line 280
  __cil_tmp145 = (char const   * __restrict  )"canary should be GOOD\n";
#line 280
  printf(__cil_tmp145);
#line 281
  __cil_tmp146 = (char const   * __restrict  )"canary = %s\n";
#line 281
  __cil_tmp147 = 0 * 1UL;
#line 281
  __cil_tmp148 = (unsigned long )(canary) + __cil_tmp147;
#line 281
  __cil_tmp149 = (char *)__cil_tmp148;
#line 281
  printf(__cil_tmp146, __cil_tmp149);
  }
#line 282
  return;
}
}
#line 304 "mime2-bad.c"
char *hvalue(char *field , HDR *header ) 
{ register HDR *h ;
  int tmp ;
  void *__cil_tmp5 ;
  unsigned long __cil_tmp6 ;
  unsigned long __cil_tmp7 ;
  unsigned long __cil_tmp8 ;
  unsigned long __cil_tmp9 ;
  u_short __cil_tmp10 ;
  int __cil_tmp11 ;
  int __cil_tmp12 ;
  int __cil_tmp13 ;
  char *__cil_tmp14 ;
  char const   *__cil_tmp15 ;
  char const   *__cil_tmp16 ;
  unsigned long __cil_tmp17 ;
  unsigned long __cil_tmp18 ;
  unsigned long __cil_tmp19 ;
  unsigned long __cil_tmp20 ;
  void *__cil_tmp21 ;

  {
#line 310
  h = header;
  {
#line 310
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 310
    __cil_tmp5 = (void *)0;
#line 310
    __cil_tmp6 = (unsigned long )__cil_tmp5;
#line 310
    __cil_tmp7 = (unsigned long )h;
#line 310
    if (__cil_tmp7 != __cil_tmp6) {

    } else {
#line 310
      goto while_break;
    }
    }
    {
#line 312
    __cil_tmp8 = (unsigned long )h;
#line 312
    __cil_tmp9 = __cil_tmp8 + 24;
#line 312
    __cil_tmp10 = *((u_short *)__cil_tmp9);
#line 312
    __cil_tmp11 = (int )__cil_tmp10;
#line 312
    __cil_tmp12 = __cil_tmp11 & 4;
#line 312
    __cil_tmp13 = __cil_tmp12 != 0;
#line 312
    if (! __cil_tmp13) {
      {
#line 312
      __cil_tmp14 = *((char **)h);
#line 312
      __cil_tmp15 = (char const   *)__cil_tmp14;
#line 312
      __cil_tmp16 = (char const   *)field;
#line 312
      tmp = strcasecmp(__cil_tmp15, __cil_tmp16);
      }
#line 312
      if (tmp == 0) {
        {
#line 314
        __cil_tmp17 = (unsigned long )h;
#line 314
        __cil_tmp18 = __cil_tmp17 + 8;
#line 314
        return (*((char **)__cil_tmp18));
        }
      } else {

      }
    } else {

    }
    }
#line 310
    __cil_tmp19 = (unsigned long )h;
#line 310
    __cil_tmp20 = __cil_tmp19 + 16;
#line 310
    h = *((struct header **)__cil_tmp20);
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 316
  __cil_tmp21 = (void *)0;
#line 316
  return ((char *)__cil_tmp21);
  }
}
}
