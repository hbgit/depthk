/* Generated by CIL v. 1.3.7 */
/* print_CIL_Input is true */

#line 211 "/usr/lib/gcc/x86_64-linux-gnu/4.4.3/include/stddef.h"
typedef unsigned long size_t;
#line 119 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) int toupper(int __c ) ;
#line 339 "/usr/include/stdio.h"
extern int printf(char const   * __restrict  __format  , ...) ;
#line 363
extern  __attribute__((__nothrow__)) int ( /* format attribute */  snprintf)(char * __restrict  __s ,
                                                                             size_t __maxlen ,
                                                                             char const   * __restrict  __format 
                                                                             , ...) ;
#line 819
extern void perror(char const   *__s ) ;
#line 130 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) char *strncpy(char * __restrict  __dest , char const   * __restrict  __src ,
                                                   size_t __n )  __attribute__((__nonnull__(1,2))) ;
#line 397
extern  __attribute__((__nothrow__)) size_t strlen(char const   *__s )  __attribute__((__pure__,
__nonnull__(1))) ;
#line 471 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *malloc(size_t __size )  __attribute__((__malloc__)) ;
#line 74 "sendmail-ok.h"
char *xalloc(int sz ) ;
#line 75
void buildfname(char *gecos , char *login , char *buf , int buflen ) ;
#line 87 "util-ok.c"
char *xalloc(int sz ) 
{ register char *p ;
  void *tmp ;
  unsigned int __cil_tmp4 ;
  size_t __cil_tmp5 ;
  void *__cil_tmp6 ;
  unsigned long __cil_tmp7 ;
  unsigned long __cil_tmp8 ;

  {
#line 94
  if (sz <= 0) {
#line 95
    sz = 1;
  } else {

  }
  {
#line 97
  __cil_tmp4 = (unsigned int )sz;
#line 97
  __cil_tmp5 = (size_t )__cil_tmp4;
#line 97
  tmp = malloc(__cil_tmp5);
#line 97
  p = (char *)tmp;
  }
  {
#line 98
  __cil_tmp6 = (void *)0;
#line 98
  __cil_tmp7 = (unsigned long )__cil_tmp6;
#line 98
  __cil_tmp8 = (unsigned long )p;
#line 98
  if (__cil_tmp8 == __cil_tmp7) {
    {
#line 100
    perror("Out of memory!!");
    }
  } else {

  }
  }
#line 102
  return (p);
}
}
#line 123 "util-ok.c"
void buildfname(char *gecos , char *login , char *buf , int buflen ) 
{ register char *p ;
  register char *bp ;
  int l ;
  size_t tmp ;
  size_t tmp___0 ;
  size_t tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  char *tmp___4 ;
  char __cil_tmp14 ;
  int __cil_tmp15 ;
  char __cil_tmp16 ;
  int __cil_tmp17 ;
  char __cil_tmp18 ;
  int __cil_tmp19 ;
  char __cil_tmp20 ;
  int __cil_tmp21 ;
  char __cil_tmp22 ;
  int __cil_tmp23 ;
  char __cil_tmp24 ;
  int __cil_tmp25 ;
  char const   *__cil_tmp26 ;
  size_t __cil_tmp27 ;
  size_t __cil_tmp28 ;
  int __cil_tmp29 ;
  char const   * __restrict  __cil_tmp30 ;
  char const   * __restrict  __cil_tmp31 ;
  char const   * __restrict  __cil_tmp32 ;
  char const   *__cil_tmp33 ;
  char const   * __restrict  __cil_tmp34 ;
  char * __restrict  __cil_tmp35 ;
  size_t __cil_tmp36 ;
  char const   * __restrict  __cil_tmp37 ;
  char __cil_tmp38 ;
  int __cil_tmp39 ;
  char __cil_tmp40 ;
  int __cil_tmp41 ;
  char __cil_tmp42 ;
  int __cil_tmp43 ;
  char __cil_tmp44 ;
  int __cil_tmp45 ;
  char __cil_tmp46 ;
  int __cil_tmp47 ;
  char const   * __restrict  __cil_tmp48 ;
  char const   * __restrict  __cil_tmp49 ;
  char const   * __restrict  __cil_tmp50 ;
  int __cil_tmp51 ;
  unsigned long __cil_tmp52 ;
  unsigned long __cil_tmp53 ;
  char const   *__cil_tmp54 ;
  char const   * __restrict  __cil_tmp55 ;
  char * __restrict  __cil_tmp56 ;
  char const   * __restrict  __cil_tmp57 ;
  int __cil_tmp58 ;
  unsigned long __cil_tmp59 ;
  unsigned long __cil_tmp60 ;
  char __cil_tmp61 ;
  int __cil_tmp62 ;
  char const   *__cil_tmp63 ;
  char const   * __restrict  __cil_tmp64 ;
  char const   * __restrict  __cil_tmp65 ;
  int __cil_tmp66 ;
  char const   * __restrict  __cil_tmp67 ;

  {
#line 131
  bp = buf;
  {
#line 134
  __cil_tmp14 = *gecos;
#line 134
  __cil_tmp15 = (int )__cil_tmp14;
#line 134
  if (__cil_tmp15 == 42) {
#line 135
    gecos = gecos + 1;
  } else {

  }
  }
#line 138
  l = 0;
#line 139
  p = gecos;
  {
#line 139
  while (1) {
    while_continue: /* CIL Label */ ;
    {
#line 139
    __cil_tmp16 = *p;
#line 139
    __cil_tmp17 = (int )__cil_tmp16;
#line 139
    if (__cil_tmp17 != 0) {
      {
#line 139
      __cil_tmp18 = *p;
#line 139
      __cil_tmp19 = (int )__cil_tmp18;
#line 139
      if (__cil_tmp19 != 44) {
        {
#line 139
        __cil_tmp20 = *p;
#line 139
        __cil_tmp21 = (int )__cil_tmp20;
#line 139
        if (__cil_tmp21 != 59) {
          {
#line 139
          __cil_tmp22 = *p;
#line 139
          __cil_tmp23 = (int )__cil_tmp22;
#line 139
          if (__cil_tmp23 != 37) {

          } else {
#line 139
            goto while_break;
          }
          }
        } else {
#line 139
          goto while_break;
        }
        }
      } else {
#line 139
        goto while_break;
      }
      }
    } else {
#line 139
      goto while_break;
    }
    }
    {
#line 141
    __cil_tmp24 = *p;
#line 141
    __cil_tmp25 = (int )__cil_tmp24;
#line 141
    if (__cil_tmp25 == 38) {
      {
#line 142
      __cil_tmp26 = (char const   *)login;
#line 142
      tmp = strlen(__cil_tmp26);
#line 142
      __cil_tmp27 = (size_t )l;
#line 142
      __cil_tmp28 = __cil_tmp27 + tmp;
#line 142
      l = (int )__cil_tmp28;
      }
    } else {
#line 144
      l = l + 1;
    }
    }
#line 139
    p = p + 1;
  }
  while_break: /* CIL Label */ ;
  }
  {
#line 146
  __cil_tmp29 = buflen - 1;
#line 146
  if (l > __cil_tmp29) {
    {
#line 149
    __cil_tmp30 = (char const   * __restrict  )"snprintf (buf, buflen, format, gecos)\n";
#line 149
    printf(__cil_tmp30);
#line 150
    __cil_tmp31 = (char const   * __restrict  )"sizeof (buf) = %d\n";
#line 150
    printf(__cil_tmp31, 8UL);
#line 151
    __cil_tmp32 = (char const   * __restrict  )"buflen = %d\n";
#line 151
    printf(__cil_tmp32, buflen);
#line 152
    __cil_tmp33 = (char const   *)gecos;
#line 152
    tmp___0 = strlen(__cil_tmp33);
#line 152
    __cil_tmp34 = (char const   * __restrict  )"strlen (gecos)=%d\n";
#line 152
    printf(__cil_tmp34, tmp___0);
#line 154
    __cil_tmp35 = (char * __restrict  )buf;
#line 154
    __cil_tmp36 = (size_t )buflen;
#line 154
    __cil_tmp37 = (char const   * __restrict  )"%s";
#line 154
    snprintf(__cil_tmp35, __cil_tmp36, __cil_tmp37, gecos);
    }
#line 155
    return;
  } else {

  }
  }
#line 159
  p = gecos;
  {
#line 159
  while (1) {
    while_continue___0: /* CIL Label */ ;
    {
#line 159
    __cil_tmp38 = *p;
#line 159
    __cil_tmp39 = (int )__cil_tmp38;
#line 159
    if (__cil_tmp39 != 0) {
      {
#line 159
      __cil_tmp40 = *p;
#line 159
      __cil_tmp41 = (int )__cil_tmp40;
#line 159
      if (__cil_tmp41 != 44) {
        {
#line 159
        __cil_tmp42 = *p;
#line 159
        __cil_tmp43 = (int )__cil_tmp42;
#line 159
        if (__cil_tmp43 != 59) {
          {
#line 159
          __cil_tmp44 = *p;
#line 159
          __cil_tmp45 = (int )__cil_tmp44;
#line 159
          if (__cil_tmp45 != 37) {

          } else {
#line 159
            goto while_break___0;
          }
          }
        } else {
#line 159
          goto while_break___0;
        }
        }
      } else {
#line 159
        goto while_break___0;
      }
      }
    } else {
#line 159
      goto while_break___0;
    }
    }
    {
#line 161
    __cil_tmp46 = *p;
#line 161
    __cil_tmp47 = (int )__cil_tmp46;
#line 161
    if (__cil_tmp47 == 38) {
      {
#line 163
      __cil_tmp48 = (char const   * __restrict  )"snprintf(bp, SPACELEFT(buf, bp), format, login)\n";
#line 163
      printf(__cil_tmp48);
#line 164
      __cil_tmp49 = (char const   * __restrict  )"sizeof(bp) = %d\n";
#line 164
      printf(__cil_tmp49, 8UL);
#line 165
      __cil_tmp50 = (char const   * __restrict  )"SPACELEFT(buf,bp)=%d\n";
#line 165
      __cil_tmp51 = bp - buf;
#line 165
      __cil_tmp52 = (unsigned long )__cil_tmp51;
#line 165
      __cil_tmp53 = 8UL - __cil_tmp52;
#line 165
      printf(__cil_tmp50, __cil_tmp53);
#line 166
      __cil_tmp54 = (char const   *)login;
#line 166
      tmp___1 = strlen(__cil_tmp54);
#line 166
      __cil_tmp55 = (char const   * __restrict  )"strlen(login)=%d\n";
#line 166
      printf(__cil_tmp55, tmp___1);
      }
      {
#line 169
      __cil_tmp56 = (char * __restrict  )bp;
#line 169
      __cil_tmp57 = (char const   * __restrict  )login;
#line 169
      __cil_tmp58 = bp - buf;
#line 169
      __cil_tmp59 = (unsigned long )__cil_tmp58;
#line 169
      __cil_tmp60 = 8UL - __cil_tmp59;
#line 169
      strncpy(__cil_tmp56, __cil_tmp57, __cil_tmp60);
#line 171
      __cil_tmp61 = *bp;
#line 171
      __cil_tmp62 = (int )__cil_tmp61;
#line 171
      tmp___2 = toupper(__cil_tmp62);
#line 171
      *bp = (char )tmp___2;
#line 172
      __cil_tmp63 = (char const   *)bp;
#line 172
      tmp___3 = strlen(__cil_tmp63);
#line 172
      bp = bp + tmp___3;
      }
    } else {
      {
#line 175
      __cil_tmp64 = (char const   * __restrict  )"*bp++=*p\n:";
#line 175
      printf(__cil_tmp64);
#line 176
      __cil_tmp65 = (char const   * __restrict  )"bp-buf=%d\n";
#line 176
      __cil_tmp66 = bp - buf;
#line 176
      printf(__cil_tmp65, __cil_tmp66);
      }
#line 179
      tmp___4 = bp;
#line 179
      bp = bp + 1;
#line 179
      *tmp___4 = *p;
    }
    }
#line 159
    p = p + 1;
  }
  while_break___0: /* CIL Label */ ;
  }
  {
#line 182
  *bp = (char )'\000';
#line 184
  __cil_tmp67 = (char const   * __restrict  )"leaving buildfname\n";
#line 184
  printf(__cil_tmp67);
  }
#line 185
  return;
}
}
