/* Generated by CIL v. 1.3.7 */
/* print_CIL_Input is true */

#line 14 "../versisec/MadWiFi/progs/../lib/stubs.h"
typedef int size_t;
#line 3 "../versisec/MadWiFi/progs/../constants.h"
typedef unsigned int u_int;
#line 4 "../versisec/MadWiFi/progs/../constants.h"
typedef unsigned char u_int8_t;
#line 6 "../versisec/MadWiFi/progs/../constants.h"
struct ieee80211_scan_entry {
   u_int8_t *se_rsn_ie ;
};
#line 32 "../versisec/MadWiFi/progs/../lib/stubs.h"
extern void *memcpy(void *dest , void const   *src , size_t n ) ;
#line 71 "/usr/include/assert.h"
extern  __attribute__((__nothrow__, __noreturn__)) void __assert_fail(char const   *__assertion ,
                                                                      char const   *__file ,
                                                                      unsigned int __line ,
                                                                      char const   *__function ) ;
#line 4 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
static u_int encode_ie(void *buf , size_t bufsize , u_int8_t const   *ie , size_t ielen ,
                       char const   *leader , size_t leader_len ) 
{ void *bufend ;
  u_int8_t *p ;
  int i ;
  int tmp ;
  void *__cil_tmp11 ;
  void const   *__cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  unsigned long __cil_tmp14 ;
  unsigned long __cil_tmp15 ;
  u_int8_t *__cil_tmp16 ;
  unsigned long __cil_tmp17 ;
  u_int8_t *__cil_tmp18 ;
  u_int8_t *__cil_tmp19 ;

  {
#line 9
  bufend = buf + bufsize;
#line 16
  if (bufsize < leader_len) {
#line 17
    return (0U);
  } else {

  }
  {
#line 18
  p = (u_int8_t *)buf;
#line 19
  __cil_tmp11 = (void *)p;
#line 19
  __cil_tmp12 = (void const   *)leader;
#line 19
  memcpy(__cil_tmp11, __cil_tmp12, leader_len);
#line 20
  bufsize = bufsize - leader_len;
#line 21
  p = p + leader_len;
#line 23
  i = 0;
  }
  {
#line 23
  while (1) {
    while_0_continue: /* CIL Label */ ;
#line 23
    if (i < ielen) {
#line 23
      if (bufsize > 2) {

      } else {
        goto while_0_break;
      }
    } else {
      goto while_0_break;
    }
    {
#line 34
    __cil_tmp13 = (unsigned long )bufend;
#line 34
    __cil_tmp14 = (unsigned long )p;
#line 34
    if (__cil_tmp14 < __cil_tmp13) {

    } else {
      {
#line 34
      __assert_fail("p < bufend", "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c",
                    34U, "encode_ie");
      }
    }
    }
#line 35
    *p = (unsigned char )'x';
    {
#line 38
    __cil_tmp15 = (unsigned long )bufend;
#line 38
    __cil_tmp16 = p + 1;
#line 38
    __cil_tmp17 = (unsigned long )__cil_tmp16;
#line 38
    if (__cil_tmp17 < __cil_tmp15) {

    } else {
      {
#line 38
      __assert_fail("p+1 < bufend", "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c",
                    38U, "encode_ie");
      }
    }
    }
#line 39
    __cil_tmp18 = p + 1;
#line 39
    *__cil_tmp18 = (unsigned char )'x';
#line 40
    p = p + 2;
#line 23
    i = i + 1;
  }
  while_0_break: /* CIL Label */ ;
  }
#line 45
  if (i == ielen) {
#line 45
    __cil_tmp19 = (u_int8_t *)buf;
#line 45
    tmp = p - __cil_tmp19;
  } else {
#line 45
    tmp = 0;
  }
#line 45
  return ((unsigned int )tmp);
}
}
#line 49 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
static int giwscan_cb(struct ieee80211_scan_entry  const  *se ) 
{ u_int8_t buf[6] ;
  char rsn_leader[1] ;
  void *__cil_tmp4 ;
  unsigned long __cil_tmp5 ;
  u_int8_t *__cil_tmp6 ;
  unsigned long __cil_tmp7 ;
  u_int8_t *__cil_tmp8 ;
  u_int8_t *__cil_tmp9 ;
  u_int8_t __cil_tmp10 ;
  int __cil_tmp11 ;
  unsigned long __cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  u_int8_t *__cil_tmp14 ;
  void *__cil_tmp15 ;
  int __cil_tmp16 ;
  u_int8_t *__cil_tmp17 ;
  u_int8_t const   *__cil_tmp18 ;
  u_int8_t *__cil_tmp19 ;
  u_int8_t *__cil_tmp20 ;
  u_int8_t __cil_tmp21 ;
  int __cil_tmp22 ;
  int __cil_tmp23 ;
  unsigned long __cil_tmp24 ;
  unsigned long __cil_tmp25 ;
  char *__cil_tmp26 ;
  char const   *__cil_tmp27 ;
  int __cil_tmp28 ;

  {
  {
#line 57
  __cil_tmp4 = (void *)0;
#line 57
  __cil_tmp5 = (unsigned long )__cil_tmp4;
#line 57
  __cil_tmp6 = *((u_int8_t * const  *)se);
#line 57
  __cil_tmp7 = (unsigned long )__cil_tmp6;
#line 57
  if (__cil_tmp7 != __cil_tmp5) {
    {
#line 58
    __cil_tmp8 = *((u_int8_t * const  *)se);
#line 58
    __cil_tmp9 = __cil_tmp8 + 0;
#line 58
    __cil_tmp10 = *__cil_tmp9;
#line 58
    __cil_tmp11 = (int )__cil_tmp10;
#line 58
    if (__cil_tmp11 == 200) {
      {
#line 59
      __cil_tmp12 = 0 * 1UL;
#line 59
      __cil_tmp13 = (unsigned long )(buf) + __cil_tmp12;
#line 59
      __cil_tmp14 = (u_int8_t *)__cil_tmp13;
#line 59
      __cil_tmp15 = (void *)__cil_tmp14;
#line 59
      __cil_tmp16 = (int )6UL;
#line 59
      __cil_tmp17 = *((u_int8_t * const  *)se);
#line 59
      __cil_tmp18 = (u_int8_t const   *)__cil_tmp17;
#line 59
      __cil_tmp19 = *((u_int8_t * const  *)se);
#line 59
      __cil_tmp20 = __cil_tmp19 + 1;
#line 59
      __cil_tmp21 = *__cil_tmp20;
#line 59
      __cil_tmp22 = (int )__cil_tmp21;
#line 59
      __cil_tmp23 = __cil_tmp22 + 2;
#line 59
      __cil_tmp24 = 0 * 1UL;
#line 59
      __cil_tmp25 = (unsigned long )(rsn_leader) + __cil_tmp24;
#line 59
      __cil_tmp26 = (char *)__cil_tmp25;
#line 59
      __cil_tmp27 = (char const   *)__cil_tmp26;
#line 59
      __cil_tmp28 = (int )1UL;
#line 59
      encode_ie(__cil_tmp15, __cil_tmp16, __cil_tmp18, __cil_tmp23, __cil_tmp27, __cil_tmp28);
      }
    } else {

    }
    }
  } else {

  }
  }
#line 64
  return (0);
}
}
#line 67 "../versisec/MadWiFi/progs/MADWiFiCVE-2006-6332encode_ie_interproc_bad.c"
int main(void) 
{ struct ieee80211_scan_entry se ;
  u_int8_t ie[5] ;
  struct ieee80211_scan_entry *__cil_tmp3 ;
  unsigned long __cil_tmp4 ;
  unsigned long __cil_tmp5 ;
  struct ieee80211_scan_entry *__cil_tmp6 ;
  u_int8_t *__cil_tmp7 ;
  u_int8_t *__cil_tmp8 ;
  struct ieee80211_scan_entry *__cil_tmp9 ;
  u_int8_t *__cil_tmp10 ;
  u_int8_t *__cil_tmp11 ;
  struct ieee80211_scan_entry  const  *__cil_tmp12 ;

  {
  {
#line 71
  __cil_tmp3 = & se;
#line 71
  __cil_tmp4 = 0 * 1UL;
#line 71
  __cil_tmp5 = (unsigned long )(ie) + __cil_tmp4;
#line 71
  *((u_int8_t **)__cil_tmp3) = (u_int8_t *)__cil_tmp5;
#line 72
  __cil_tmp6 = & se;
#line 72
  __cil_tmp7 = *((u_int8_t **)__cil_tmp6);
#line 72
  __cil_tmp8 = __cil_tmp7 + 0;
#line 72
  *__cil_tmp8 = (unsigned char)200;
#line 73
  __cil_tmp9 = & se;
#line 73
  __cil_tmp10 = *((u_int8_t **)__cil_tmp9);
#line 73
  __cil_tmp11 = __cil_tmp10 + 1;
#line 73
  *__cil_tmp11 = (unsigned char)3;
#line 75
  __cil_tmp12 = (struct ieee80211_scan_entry  const  *)(& se);
#line 75
  giwscan_cb(__cil_tmp12);
  }
#line 77
  return (0);
}
}
